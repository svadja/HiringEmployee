<form role="form">
	<script cam-script type="text/form-script">

	$scope.positions = [];
	$scope.units = [];
	$scope.departments = [];
	
	
	
	
	$scope.datePicker = {
			birthDateOpened:false,
			workDateOpened:false,
			birthDate:new Date(),
			workDate:new Date()
			};

	$scope.openBirthDate = function($event) {
        $event.preventDefault();
        $event.stopPropagation();
        $scope.datePicker.birthDateOpened = true;
    };
    
	$scope.openWorkDate = function($event) {
        $event.preventDefault();
        $event.stopPropagation();
        $scope.datePicker.workDateOpened = true;
    };	

	var application = $scope.application = {
		person: {},
		job:{}
	};

	inject(['$http', 'Uri', function($http, Uri) {
        camForm.on('form-loaded', function() {
            camForm.variableManager.createVariable({
                name: 'application',
                type: 'Object',
                value: application,
                valueInfo: {
                    serializationDataFormat: 'application/json',
                    objectTypeName: 'ua.com.integrity.model.Application'
                }
            });
        });
		
		$http({
                method: 'GET',
                url: '/api/positions',
                data: {}
            }).success(function(result) {
                for (var el in result) {
                    $scope.positions.push(result[el]);
               }
        });
		
		$http({
            method: 'GET',
            url: '/api/units',
            data: {}
        }).success(function(result) {
            for (var el in result) {
                $scope.units.push(result[el]);
           }
        });
		
		$http({
            method: 'GET',
            url: '/api/departments',
            data: {}
        }).success(function(result) {
            for (var el in result) {
                $scope.departments.push(result[el]);
           }
        });
		
    }]);

	
    camForm.on('submit', function(e) {
        $scope.application.person.birthDate = new Date($scope.datePicker.birthDate);
        $scope.application.job.workDate = new Date($scope.datePicker.workDate);
    });
    
    </script>
	<div ng-include="'/forms/hiring/hiring-form.html'"></div>

</form>
